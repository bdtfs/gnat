{{if .}}
<div class="list">
    {{range .}}
    <div class="run-card {{if eq .status "running"}}pulsing{{end}}">
    <div class="run-header">
        <div class="run-title">
            <span class="status status-{{.status}}">{{.status}}</span>
            <span class="run-id">{{.id}}</span>
        </div>
        <div class="run-actions">
            <button class="btn btn-sm"
                    hx-get="/runs/{{.id}}"
                    hx-target="#run-detail-modal"
                    onclick="showModal()">
                Details
            </button>
            {{if eq .status "running"}}
            <button class="btn btn-sm btn-warning"
                    hx-post="/runs/{{.id}}/cancel"
                    hx-confirm="Cancel this run?">
                ‚è∏ Cancel
            </button>
            {{end}}
        </div>
    </div>

    <div class="run-timing">
        {{if .started_at}}
        <div class="timing-item">
            <span class="timing-label">Started:</span>
            <span class="timing-value">{{formatTime .started_at}}</span>
        </div>
        {{end}}
        {{if .elapsed}}
        <div class="timing-item">
            <span class="timing-label">Elapsed:</span>
            <span class="timing-value">{{formatDuration .elapsed}}</span>
        </div>
        {{end}}
    </div>

    {{if .stats}}
    <div class="run-stats">
        <div class="stat-box">
            <div class="stat-label">Requests</div>
            <div class="stat-value">{{.stats.total}}</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Success</div>
            <div class="stat-value stat-success">{{.stats.success}}</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Failed</div>
            <div class="stat-value {{if gt .stats.failed 0}}stat-error{{end}}">{{.stats.failed}}</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Avg Latency</div>
            <div class="stat-value">{{formatFloat .stats.avg_latency_ms}}ms</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">P95</div>
            <div class="stat-value">{{formatFloat .stats.p95_latency_ms}}ms</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">RPS</div>
            <div class="stat-value stat-primary">{{formatFloat .stats.rps}}</div>
        </div>
    </div>
    {{end}}
</div>
{{end}}
</div>
{{else}}
<div class="empty-state">
    <p>No runs yet. Start a test setup to begin.</p>
</div>
{{end}}

<div id="run-detail-modal" class="modal" onclick="hideModal(event)">
</div>

<script>
    function showModal() {
        document.getElementById('run-detail-modal').classList.add('show');
    }

    function hideModal(e) {
        if (e.target.className === 'modal show' || e.target.className === 'modal-close') {
            document.getElementById('run-detail-modal').classList.remove('show');
        }
    }
</script>